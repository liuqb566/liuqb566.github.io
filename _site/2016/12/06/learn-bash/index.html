<!DOCTYPE html>
<html>

  <head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>认识与学习bash</title>

	<link rel="shortcut icon" href="/styles/images/favicon.jpg">
	<link rel="icon" href="/styles/images/favicon.jpg">

	<link rel="stylesheet" href="/styles/css/index.css">
	<link rel="stylesheet" href="/styles/css/fontawesome/css/font-awesome.min.css">
	<link rel="canonical" href="/2016/12/06/learn-bash/">
	<link rel="alternate" type="application/rss+xml" title="Gossie's daily life" href="/feed.xml">
	
	<meta name="description" content="">

	<script src="/styles/js/jquery.min.js"></script>
	<!--[if lt IE 9]>
    	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  	<![endif]-->
  	<script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "//hm.baidu.com/hm.js?94be4b0f9fc5d94cc0d0415ea6761ae9";
		  var s = document.getElementsByTagName("script")[0]; 
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>
  	<style type="text/css">
	  	.docs-content{
	  		margin-bottom: 10px;
	  	}
  	</style>
</head>


  <body class="index">

    <header class="navbar navbar-inverse navbar-fixed-top docs-nav" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="/" class="navbar-brand">
        <img src="/styles/images/logo.jpg">
      </a>
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">    
        <li>
          <a href="/">Home</a>
        </li>
        <li>
          <a href="/categories/">分类</a>
        </li>
        <li>
          <a href="/tag">标签</a>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
          <a href="/donate/"><strong>打赏</strong></a>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">关于<b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a rel="nofollow" target="_blank" href="https://github.com/liuqibao566">Github</a></li>
            <li><a rel="nofollow" target="_blank" href="">关于作者</a></li>
            <li><a rel="nofollow" href="/books">书架</a></li>
            <li><a rel="nofollow" href="/reference">相关链接</a></li>
            <li><a href="/feed.xml">RSS订阅</a></li>
            <li class="divider"></li>
            <li><a rel="nofollow" target="_blank" href="https://github.com/liuqb566/">本项目</a></li>
          </ul>
        </li>
      </ul>
    </nav>
  </div>
</header>

    <div class="docs-header" id="content">
  <div class="container">
  	
  		<!--
		    <h1>认识与学习bash</h1>
		    <p>Post on Dec 06, 2016 by <a href="/about">Gossie</a></p>
		-->
		    <h1></h1>
    
  </div>
</div>
    
      
<div class="banner">
  <div class="container">
  	
    	<a href="/categories/#Linux-ref">Linux</a>	/
    	<a href="/tag/#鸟哥的Linux私房菜-ref">鸟哥的Linux私房菜</a>
    
  </div>
</div>

    

    <div class="container docs-container">
  <div class="row">
    <div class="col-md-3">
      <div class="sidebar hidden-print" role="complementary">
        <div id="navigation">
  <h1>目录</h1>
  <ul class="nav sidenav">
<!--
    
      
      
      
      

      
        <li><a href="#year_2017">2017</a>
          <ul class="nav">
            <li><a href="#month_2017_October">October</a></li>
      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_June">June</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_May">May</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_April">April</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_March">March</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_February">February</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_January">January</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
        
            </ul>
          </li>
          <li><a href="#year_2016">2016</a>
            <ul class="nav">
              <li><a href="#month_2016_December">December</a></li>
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2016_November">November</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            </ul>
          </li>
      
    
-->
  </ul>
</div> 
      </div>
    </div>
    <div class="col-md-9" role="main">
      <div class="panel docs-content">
        <div class="wrapper">
            <header class="post-header">
              <h1 class="post-title">认识与学习bash</h1>
              <!--
                <p class="post-meta">Dec 6, 2016</p>
              -->
              <div class="meta">Posted on <span class="postdate">Dec 06, 2016</span> By <a target="_blank" href="http://localhost:4000">Gossie</a></div>
              <br />
            </header>
            <article class="post-content">
              <ul id="markdown-toc">
  <li><a href="#bash-shell-type" id="markdown-toc-bash-shell-type">Bash shell 的内建命令：type</a></li>
  <li><a href="#section" id="markdown-toc-section">指令的下达</a></li>
  <li><a href="#shell-" id="markdown-toc-shell-">Shell 的变量功能</a>    <ul>
      <li><a href="#bash-" id="markdown-toc-bash-">影响 bash 环境操作的变量</a></li>
      <li><a href="#echounset" id="markdown-toc-echounset">变量的取用与设定：echo，变量设定规则，unset</a></li>
      <li><a href="#section-1" id="markdown-toc-section-1">环境变量的功能</a></li>
      <li><a href="#locale" id="markdown-toc-locale">影响显示结果的语系变量 (locale)</a></li>
      <li><a href="#section-2" id="markdown-toc-section-2">变量的有效范围</a></li>
      <li><a href="#read-array-declare" id="markdown-toc-read-array-declare">变量键盘读取、数组与宣告： read, array, declare</a></li>
      <li><a href="#section-3" id="markdown-toc-section-3">变量内容的删除、取代与替换</a></li>
      <li><a href="#section-4" id="markdown-toc-section-4">命令别名</a></li>
      <li><a href="#section-5" id="markdown-toc-section-5">路径与指令搜寻顺序</a></li>
      <li><a href="#bash-etcissueetcmotd" id="markdown-toc-bash-etcissueetcmotd">bash 的进站与欢迎讯息：<code class="highlighter-rouge">/etc/issue</code>,<code class="highlighter-rouge">/etc/motd</code></a></li>
      <li><a href="#bash--1" id="markdown-toc-bash--1">bash 的环境配置文件</a></li>
      <li><a href="#section-6" id="markdown-toc-section-6">数据流重导向</a></li>
      <li><a href="#section-7" id="markdown-toc-section-7">命令执行的判断依据:<code class="highlighter-rouge">;</code> <code class="highlighter-rouge">&amp;&amp;</code> <code class="highlighter-rouge">||</code></a></li>
      <li><a href="#pipe" id="markdown-toc-pipe">管线命令 (pipe)</a></li>
      <li><a href="#sortwcuniq" id="markdown-toc-sortwcuniq">排序命令：<code class="highlighter-rouge">sort</code>，<code class="highlighter-rouge">wc</code>，<code class="highlighter-rouge">uniq</code></a></li>
      <li><a href="#trcoljoinpasteexpand" id="markdown-toc-trcoljoinpasteexpand">字符转换命令：<code class="highlighter-rouge">tr</code>,<code class="highlighter-rouge">col</code>,<code class="highlighter-rouge">join</code>,<code class="highlighter-rouge">paste</code>,<code class="highlighter-rouge">expand</code></a></li>
    </ul>
  </li>
</ul>

<h3 id="bash-shell-type">Bash shell 的内建命令：type</h3>

<div class="highlighter-rouge">type [-tpa] name
</div>

<h3 id="section">指令的下达</h3>

<p>如果指令串太长，用反斜杠<code class="highlighter-rouge">\[Enter]</code>换行。</p>

<h3 id="shell-">Shell 的变量功能</h3>

<h4 id="bash-">影响 bash 环境操作的变量</h4>

<ul>
  <li>PATH</li>
  <li>HOME</li>
  <li>MAIL</li>
  <li>SHELL</li>
  <li>…</li>
</ul>

<h4 id="echounset">变量的取用与设定：echo，变量设定规则，unset</h4>

<ul>
  <li>
    <p>变数的取用：echo
<code class="highlighter-rouge">
echo $HOME    
echo $PATH    
myname=Liuqb " 设定一个变量  
</code></p>
  </li>
  <li>
    <p>变量的设定规则</p>
  </li>
</ul>

<blockquote>
  <ol>
    <li>以<code class="highlighter-rouge">=</code>号结</li>
    <li>等号两边不能有空格</li>
    <li>只能是英文字母与数字，但开头不能是数字。</li>
    <li>变量内容若有空格符可使用双引号<code class="highlighter-rouge">“</code>或单引号<code class="highlighter-rouge">‘</code>连接。
&gt; - 双引号内的特殊字符如<code class="highlighter-rouge">$</code>能保持原有特性。
&gt; - 单引号内的特殊字符仅为一般纯文本。</li>
  </ol>
</blockquote>

<blockquote>
  <ol>
    <li>可用跳脱字符<code class="highlighter-rouge">\</code>将特殊符号转义</li>
    <li>扩增变量
  <code class="highlighter-rouge">eg. PATH="PATH":/home/bin</code></li>
    <li>取消变量：unset
  <code class="highlighter-rouge">eg. unset myname</code></li>
  </ol>
</blockquote>

<hr />

<ol>
  <li>如何进入目前核心扩模块目录？
<code class="highlighter-rouge">
cd /lib/modules/`uname -r`/kernel  
cd /lib/modules/$(uname -r)/kernel
</code></li>
</ol>

<p><strong>反引号（<code class="highlighter-rouge">）后的命令会先执行，</code>uname -r<code class="highlighter-rouge">先获得核心版本号，然后</code>cd`进入kernel目录</strong></p>

<ol>
  <li>小技巧：如何将一个常去的工作目录简化？</li>
</ol>

<p>如进入一个目录，需<code class="highlighter-rouge">cd github/liuqb566.io/_draft</code>可以用以下命令：
<code class="highlighter-rouge">
work="~/github/liuqb566.io/_draft"  
cd $work
</code></p>

<p><strong><code class="highlighter-rouge">work</code>变量可以在<code class="highlighter-rouge">bash</code>的配置文件中直接指定</strong><br />
<strong>ps:</strong> 也可以用<code class="highlighter-rouge">alias</code>别名重新映射一串常用命令。</p>

<hr />

<h4 id="section-1">环境变量的功能</h4>

<ol>
  <li>
    <p>用<code class="highlighter-rouge">env</code>观察环境变量与常见环境变量说明
 env</p>
  </li>
  <li>
    <p>用<code class="highlighter-rouge">set</code>观察所有变量（含<strong>环境变量</strong>与<strong>自定义变量</strong>）
 set</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">export</code>：自定义变量转成环境变量</p>
  </li>
</ol>

<h4 id="locale">影响显示结果的语系变量 (locale)</h4>

<div class="highlighter-rouge">locale -a
</div>

<h4 id="section-2">变量的有效范围</h4>

<h4 id="read-array-declare">变量键盘读取、数组与宣告： read, array, declare</h4>

<ul>
  <li><code class="highlighter-rouge">read</code></li>
</ul>

<div class="highlighter-rouge">[root@www ~]# read [-pt] variable
选项与参数：
-p ：后面可以接提示字符！
-t ：后面可以接等待的『秒数！』
</div>

<ul>
  <li><code class="highlighter-rouge">declare / typeset</code></li>
</ul>

<div class="highlighter-rouge">[root@www ~]# declare [-aixr] variable
选项与参数：
-a ：将后面名为 variable 的变量定义成为数组 (array) 类型
-i ：将后面名为 variable 的变量定义成为整数数字 (integer) 类型
-x ：用法与 export 一样，就是将后面的 variable 变成环境变量；
-r ：将变量设定成为 readonly 类型，该变量不可被更改内容，也不能 unset
</div>

<ul>
  <li>
    <p>数组 (array) 变量类型</p>
  </li>
  <li>
    <p>与文件系统及程序的限制关系：<code class="highlighter-rouge">ulimit</code></p>
  </li>
</ul>

<h4 id="section-3">变量内容的删除、取代与替换</h4>

<h4 id="section-4">命令别名</h4>

<ul>
  <li>
    <p>命令别名设定：<code class="highlighter-rouge">alias</code>，<code class="highlighter-rouge">unalias</code></p>

    <table>
      <tbody>
        <tr>
          <td>alias lm=’ls -al</td>
          <td>more’</td>
        </tr>
      </tbody>
    </table>
  </li>
</ul>

<hr />

<p>命令别名是<strong>新创一个新的指令， 你可以直接下达该指令</strong>的，至于变量则需要使用类似<code class="highlighter-rouge">echo </code>指令才能够呼叫出变量的内容！
***</p>

<h4 id="section-5">路径与指令搜寻顺序</h4>

<blockquote>
  <ol>
    <li>以相对/绝对路径执行指令，例如<code class="highlighter-rouge">/bin/ls </code>或<code class="highlighter-rouge">./ls </code>；</li>
    <li>由<code class="highlighter-rouge">alias</code>找到该指令来执行；</li>
    <li>由<code class="highlighter-rouge">bash</code>内建的<code class="highlighter-rouge">builtin</code>指令来执行；</li>
    <li>透过<code class="highlighter-rouge">$PATH</code>这个变量的顺序搜寻到的第一个指令来执行。</li>
  </ol>
</blockquote>

<h4 id="bash-etcissueetcmotd">bash 的进站与欢迎讯息：<code class="highlighter-rouge">/etc/issue</code>,<code class="highlighter-rouge">/etc/motd</code></h4>
<div class="highlighter-rouge">man issue
man mingetty 
man mingetty 
</div>

<p><code class="highlighter-rouge">/etc/issue.net</code>是 telnet 这个远
程登录程序用的。当我们使用 telnet 连接到主机时，主机的登入画面就会显示<code class="highlighter-rouge">/etc/issue.net</code>而不是<code class="highlighter-rouge">/etc/issue</code>！</p>

<h4 id="bash--1">bash 的环境配置文件</h4>

<h4 id="section-6">数据流重导向</h4>

<ul>
  <li>standard output 与 standard error output</li>
</ul>

<blockquote>
  <ol>
    <li>标准输入 (stdin) ：代码为 0 ，使用<code class="highlighter-rouge">&lt;</code>或<code class="highlighter-rouge">&lt;&lt;</code>；</li>
    <li>标准输出 (stdout)：代码为 1 ，使用<code class="highlighter-rouge">&gt;</code>或<code class="highlighter-rouge">&gt;&gt;</code>；</li>
    <li>标准错误输出(stderr)：代码为 2 ，使用<code class="highlighter-rouge">2&gt;</code>或<code class="highlighter-rouge">2&gt;&gt;</code>；</li>
  </ol>
</blockquote>

<ul>
  <li><code class="highlighter-rouge">/dev/null</code>垃圾桶黑洞装置与特殊写法</li>
</ul>

<p>写入同一个档案的特殊语法:<code class="highlighter-rouge">2&gt;&amp;1</code>或<code class="highlighter-rouge">&amp;&gt;</code>.</p>

<ul>
  <li>standard input:<code class="highlighter-rouge">&lt;</code>与<code class="highlighter-rouge">&lt;&lt;</code></li>
</ul>

<p>将原本需要由键盘输入的数据，改由档案内容来取代。</p>

<div class="highlighter-rouge">利用 cat 指令来建立一个档案的简单流程
[root@www ~]# cat &gt; catfile
testing
cat file test
&lt;==这里按下 [ctrl]+d 来离开
</div>
<div class="highlighter-rouge">用 stdin 取代键盘的输入以建立新档案的简单流程
[root@www ~]# cat &gt; catfile &lt; ~/.bashrc
</div>
<p><strong><code class="highlighter-rouge">&lt;&lt; </code>结束输入</strong>我要用<code class="highlighter-rouge">cat</code>直接将输入的讯息输出到<code class="highlighter-rouge">catfile</code>中， 且当由键盘输入 <code class="highlighter-rouge">eof</code>时，该次输入就结束:
<code class="highlighter-rouge">
[root@www ~]# cat &gt; catfile &lt;&lt; "eof"
&gt; This is a test.
&gt; OK now stop
&gt; eof &lt;==输入这关键词，立刻就结束而不需要输入 [ctrl]+d
</code></p>

<h4 id="section-7">命令执行的判断依据:<code class="highlighter-rouge">;</code> <code class="highlighter-rouge">&amp;&amp;</code> <code class="highlighter-rouge">||</code></h4>

<ul>
  <li><code class="highlighter-rouge">cmd;cmd</code>(不考虑指令相关性的连续指令下达)</li>
  <li><code class="highlighter-rouge">$?</code>(指令回传值）与<code class="highlighter-rouge">&amp;&amp;</code>或<code class="highlighter-rouge">||</code></li>
</ul>

<blockquote>
  <p><strong>若前一个指令执行的结果为正确，在 Linux 底下会回传一个<code class="highlighter-rouge">$? = 0</code>的值。</strong><br />
&gt; cmd1 &amp;&amp; cmd2 <br />
1. 若 cmd1 执行完毕且正确执行($?=0)，则开始执行 cmd2。
2. 若 cmd1 执行完毕且为错误 ($?≠0)，则 cmd2 不执行。<br />
&gt; cmd1 || cmd2<br />
1. 若 cmd1 执行完毕且正确执行($?=0)，则 cmd2 不执行。
2. 若 cmd1 执行完毕且为错误 ($?≠0)，则开始执行 cmd2。</p>
</blockquote>

<h4 id="pipe">管线命令 (pipe)</h4>

<p><strong>管线命令<code class="highlighter-rouge">|</code>仅能处理经由前面一个指令传来的正确信息，也就是 standard output 的信息，对于 stdandard error 并没有直接处理的能力。</strong></p>

<blockquote>
  <ol>
    <li>管线命令仅会处理 standard output，对于 standard error output 会予以忽略</li>
    <li>管线命令必须要能够接受来自前一个指令的数据成为 standard input 继续处理才行。</li>
  </ol>
</blockquote>

<ol>
  <li>撷取命令:<code class="highlighter-rouge">cut</code>,<code class="highlighter-rouge">grep</code><br />
一般来说，撷取讯息通常是针对 <strong>一行一行</strong> 来分析的,并不是整篇讯息分析.
&gt; <code class="highlighter-rouge">cut</code>:这个指令可以将一段讯息的某一段给他『切』出来～ 处理的讯息是以
『行』为单位.</li>
</ol>

<p><code class="highlighter-rouge">
[root@www ~]# cut -d'分隔字符' -f fields &lt;==用于有特定分隔字符
[root@www ~]# cut -c 字符区间 &lt;==用于排列整齐的讯息
选项与参数：
-d ：后面接分隔字符。与 -f 一起使用；
-f ：依据 -d 的分隔字符将一段讯息分割成为数段，用 -f 取出第几段的意思；
-c ：以字符 (characters) 的单位取出固定字符区间；
</code></p>

<p><code class="highlighter-rouge">
范例一：[root@www ~]# echo $PATH | cut -d ':' -f 5
# 如同上面的数字显示，我们是以『: 』作为分隔，因此会出现 /usr/local/bin
</code>
<code class="highlighter-rouge">
# 那么如果想要列出第 3 与第 5 呢？，就是这样：
[root@www ~]# echo $PATH | cut -d ':' -f 3,5
</code>
<code class="highlighter-rouge">
范例二：将 export 输出的讯息，取得第 12 字符以后的所有字符串
[root@www ~]# export
declare -x HISTSIZE="1000"
declare -x INPUTRC="/etc/inputrc"
declare -x KDEDIR="/usr"
declare -x LANG="zh_TW.big5"
.....(其他省略).....
</code>
<code class="highlighter-rouge">
# 注意看，每个数据都是排列整齐的输出！如果我们不想要『declare -x 』时， 就得这么做：
[root@www ~]# export | cut -c 12-
HISTSIZE="1000"
INPUTRC="/etc/inputrc"
KDEDIR="/usr"
LANG="zh_TW.big5"
.....(其他省略).....
# 知道怎么回事了吧？用 -c 可以处理比较具有格式的输出数据！
# 我们还可以指定某个范围的值，例如第 12-20 的字符，就是 cut -c 12-20 等等！
</code>
<code class="highlighter-rouge">
范例三：用 last 将显示的登入者的信息中，仅留下用户大名
[root@www ~]# last
root pts/1 192.168.201.101 Sat Feb 7 12:35 still logged in
root pts/1 192.168.201.101 Fri Feb 6 12:13 - 18:46 (06:33)
root pts/1 192.168.201.254 Thu Feb 5 22:37 - 23:53 (01:16)
# last 可以输出『账号/终端机/来源/日期时间』的数据，并且是排列整齐的
[root@www ~]# last | cut -d ' ' -f 1
# 由输出的结果我们可以发现第一个空白分隔的字段代表账号，所以使用如上指令：
# 但是因为 root pts/1 之间空格有好几个，并非仅有一个，所以，如果要找出
# pts/1 其实不能以 cut -d ' ' -f 1,2 喔！输出的结果会不是我们想要的。
</code></p>

<p><code class="highlighter-rouge">cut</code>主要的用途在于将『同一行里面的数据进行分解！』最常使用在分析一些数据或文字数据的时候！这是因为有时候我们会以某些字符当作分割的参数，然后来将数据加以切割，以取得我们所需要的数据。</p>

<ol>
  <li><code class="highlighter-rouge">grep</code>:<code class="highlighter-rouge">cut</code>是将一行讯息当中，取出某部分我们想要的，而<code class="highlighter-rouge">grep</code>则是分析一行讯息,若当中有我们所需要的信息，就将该行拿出来。</li>
</ol>

<div class="highlighter-rouge">root@www ~]# grep [-acinv] [--color=auto] '搜寻字符串' filename
选项与参数：
-a ：将 binary 档案以 text 档案的方式搜寻数据
-c ：计算找到 '搜寻字符串' 的次数
-i ：忽略大小写的不同，所以大小写视为相同
-n ：顺便输出行号
-v ：反向选择，亦即显示出没有 '搜寻字符串' 内容的那一行！
--color=auto ：可以将找到的关键词部分加上颜色的显示喔！
</div>

<h4 id="sortwcuniq">排序命令：<code class="highlighter-rouge">sort</code>，<code class="highlighter-rouge">wc</code>，<code class="highlighter-rouge">uniq</code></h4>

<ol>
  <li>sort</li>
</ol>

<p><code class="highlighter-rouge">sort</code>可以依据不同的数据型态来排序，此外，排序的字符与<strong>语系的编码</strong>有关，因此，如果您需要排序时，建议使用<strong>LANG=C</strong> 来让语系统一，数据排序比较好一些。</p>

<div class="highlighter-rouge">[root@www ~]# sort [-fbMnrtuk] [file or stdin]
选项与参数：
-f ：忽略大小写的差异，例如 A 与 a 视为编码相同；
-b ：忽略最前面的空格符部分；
-M ：以月份的名字来排序，例如 JAN, DEC 等等的排序方法；
-n ：使用『纯数字』进行排序(默认是以文字型态来排序的)；
-r ：反向排序；
-u ：就是 uniq ，相同的数据中，仅出现一行代表；
-t ：分隔符，预设是用 [tab] 键来分隔；
-k ：以那个区间 (field) 来进行排序的意思
</div>
<div class="highlighter-rouge">eg. /etc/passwd 内容是以 : 来分隔的，我想以第三栏来排序，该如何？
# 默认以文字排序
[root@www ~]# cat /etc/passwd | sort -t ':' -k 3
# 加 -n 以数字排序
cat /etc/passwd | sort -t ':' -k 3 -n
</div>
<div class="highlighter-rouge">利用 last ，将输出的数据仅取账号，并加以排序
[root@www ~]# last | cut -d ' ' -f1 | sort
</div>

<ol>
  <li>
    <p>uniq：用于将重复的行删除只显示一个
<code class="highlighter-rouge">
[root@www ~]# uniq [-ic]
选项与参数：
-i ：忽略大小写字符的不同；
-c ：进行计数
</code>
<code class="highlighter-rouge">
eg. 使用 last 将账号列出，仅取出账号栏，进行排序后仅取出一位；并统计次数
[root@www ~]# last | cut -d ' ' -f1 | sort | uniq -c
</code></p>
  </li>
  <li>
    <p>wc:可以计算输出的讯息的整体数据</p>
  </li>
</ol>

<div class="highlighter-rouge">[root@www ~]# wc [-lwm]
选项与参数：
-l ：仅列出行；
-w ：仅列出多少字(英文单字)；
-m ：多少字符；
</div>
<div class="highlighter-rouge">那个 /etc/man.config 里面到底有多少相关字、行、字符数？
[root@www ~]# cat /etc/man.config | wc
141 722 4617
# 输出的三个数字中,分别代表：行、字数、字符数
</div>

<ol>
  <li>tee: 双向重导向，tee 会同时将数据流分送到档案去与屏幕 (screen)；而输出到屏幕的，其实就是 stdout.
<code class="highlighter-rouge">
[root@www ~]# tee [-a] file
选项与参数：
-a ：以累加 (append) 的方式，将数据加入 file 当中！ 
</code></li>
</ol>

<h4 id="trcoljoinpasteexpand">字符转换命令：<code class="highlighter-rouge">tr</code>,<code class="highlighter-rouge">col</code>,<code class="highlighter-rouge">join</code>,<code class="highlighter-rouge">paste</code>,<code class="highlighter-rouge">expand</code></h4>

<ol>
  <li>
    <p>tr:可以用来删除一段讯息当中的文字，或者是进行文字讯息的替换！
<code class="highlighter-rouge">
[root@www ~]# tr [-ds] SET1 ...
选项与参数：
-d ：删除讯息当中的 SET1 这个字符串；
-s ：取代掉重复的字符！
</code>
<code class="highlighter-rouge">
范例一：将 last 输出的讯息中，所有的小写变成大写字符：
[root@www ~]# last | tr '[a-z]' '[A-Z]'
# 事实上，没有加上单引号也是可以执行的，如：『last | tr [a-z] [A-Z] 』
</code>
<code class="highlighter-rouge">
范例二：将 /etc/passwd 输出的讯息中，将冒号 (:) 删除
[root@www ~]# cat /etc/passwd | tr -d ':'
</code></p>
  </li>
  <li>
    <p>col:
<code class="highlighter-rouge">
[root@www ~]# col [-xb]
选项与参数：
-x ：将 tab 键转换成对等的空格键
-b ：在文字内有反斜杠 (/) 时，仅保留反斜杠最后接的那个字符
</code></p>
  </li>
  <li>
    <p>join: 两个档案当中，有 “相同数据” 的那一行，加在一起
<code class="highlighter-rouge">
[root@www ~]# join [-ti12] file1 file2
选项与参数：
-t ：join 默认以空格符分隔数据，并且比对『第一个字段』的数据，
如果两个档案相同，则将两笔数据联成一行，且第一个字段放在第一个！
-i ：忽略大小写的差异；
-1 ：这个是数字的 1 ，代表『第一个档案要用那个字段来分析』的意思；
-2 ：代表『第二个档案要用那个字段来分析』的意思。
</code>
<strong>在使用<code class="highlighter-rouge">join</code>之前，你所需要处理的档案应该要事先经过排序 <code class="highlighter-rouge">sort</code> 处理！
否则有些比对的项目会被略过</strong></p>
  </li>
  <li>
    <p>paste:相对于<code class="highlighter-rouge">join</code>必须要比对两个档案的数据相关性，<code class="highlighter-rouge">paste</code>就直接** 将
两行贴在一起，且中间以 [tab] 键隔开**</p>
  </li>
</ol>

<div class="highlighter-rouge">[root@www ~]# paste [-d] file1 file2
选项与参数：
-d ：后面可以接分隔字符。预设是以 [tab] 来分隔的！
- ：如果 file 部分写成 - ，表示来自 standard input 的资料的意思。
</div>

<ol>
  <li>expand:将 [tab] 按键转成空格键</li>
</ol>

<div class="highlighter-rouge">[root@www ~]# expand [-t] file
选项与参数：
-t ：后面可以接数字。一般来说，一个 tab 按键可以用 8 个空格键取代。
我们也可以自行定义一个 [tab] 按键代表多少个字符。
</div>

<ol>
  <li>split：分割命令可以将一个大档案，依据档案大小或行数来分割，就将大档案分割成为小档案。</li>
</ol>

<div class="highlighter-rouge">[root@www ~]# split [-bl] file PREFIX
选项与参数：
-b ：后面可接欲分割成的档案大小，可加单位，例如 b, k, m 等；
-l ：以行数来进行分割。
PREFIX ：代表前导符的意思，可作为分割档案的前导文字。
</div>
<div class="highlighter-rouge">范例一：我的 /etc/termcap 有七百多 K，若想要分成 300K 一个档案时？
[root@www ~]# cd /tmp; split -b 300k /etc/termcap termcap
[root@www tmp]# ll -k termcap*
-rw-r--r-- 1 root root 300 Feb 7 16:39 termcapaa
-rw-r--r-- 1 root root 300 Feb 7 16:39 termcapab
-rw-r--r-- 1 root root 189 Feb 7 16:39 termcapac
# 那个档名可以随意取的啦！我们只要写上前导文字，小档案就会以
# xxxaa, xxxab, xxxac 等方式来建立小档案的！
</div>
<div class="highlighter-rouge">范例二：如何将上面的三个小档案合成一个档案，档名为 termcapback
[root@www tmp]# cat termcap* &gt;&gt; termcapback
# 很简单吧？就用数据流重导向就好啦！简单！
</div>
<div class="highlighter-rouge">范例三：使用 ls -al / 输出的信息中，每十行记录成一个档案
[root@www tmp]# ls -al / | split -l 10 - lsroot
[root@www tmp]# wc -l lsroot*
10 lsrootaa
10 lsrootab
6 lsrootac
26 total
</div>

<p><strong>重点在那个<code class="highlighter-rouge">-</code>！一般来说，如果需要 stdout/stdin 时，但偏偏又没有档案有的只是 - 时，那么那个<code class="highlighter-rouge">-</code>就会被当成 stdin 或 stdout。</strong></p>

<ol>
  <li>xargs:参数代换</li>
</ol>

<p>x 是加减乘除的乘号，args 则是 arguments (参数)的意思，所以说，这个玩意儿就是在产生某个指令的参数的意思！** xargs 可以读入 stdin 的数据，并且以空格符或断行字符作为分辨，将 stdin 的资料分隔成为 arguments 。** 因为是以空格符作为分隔，所以，如果有一些档名或者是其他意义的名词内含有空格符的时候， xargs 可能就会误判了。</p>

<div class="highlighter-rouge">[root@www ~]# xargs [-0epn] command
选项与参数：
-0 ：如果输入的 stdin 含有特殊字符，例如 `, \, 空格键等等字符时，这个 -0 参
数可以将他还原成一般字符。这个参数可以用于特殊状态！
-e ：这个是 EOF (end of file) 的意思。后面可以接一个字符串，当 xargs 分析
到这个字符串时，就会停止继续工作！
-p ：在执行每个指令的 argument 时，都会询问使用者的意思；
-n ：后面接次数，每次 command 指令执行时，要使用几个参数的意思。
当 xargs 后面没有接任何的指令时，默认是以 echo 来进行输出！
</div>
<div class="highlighter-rouge">范例一：将 /etc/passwd 内的第一栏取出，仅取三行，使用 finger 这个指令将
每个账号内容秀出来
[root@www ~]# cut -d':' -f1 /etc/passwd |head -n 3| xargs finger
# 后的结果。在这个例子当中，我们利用 cut 取出账号名称，用 head 取出三个账号,最后则是由 xargs 将三个账号的名称变成 finger 后面需要的参数！
</div>
<div class="highlighter-rouge">范例三：将所有的 /etc/passwd 内的账号都以 finger 查阅，但一次仅查阅五个
账号
[root@www ~]# cut -d':' -f1 /etc/passwd | xargs -p -n 5 finger
</div>
<div class="highlighter-rouge">范例四：同上，但是当分析到 lp 就结束这串指令？
[root@www ~]# cut -d':' -f1 /etc/passwd | xargs -p -e'lp' finger
finger root bin daemon adm ?...
# 仔细与上面的案例做比较。也同时注意，那个 -e'lp' 是连在一起的，中间没有
空格键。
# 上个例子当中，第五个参数是 lp 啊，那么我们下达 -e'lp' 后，则分析到 lp
# 这个字符串时，后面的其他 stdin 的内容就会被 xargs 舍弃掉了！
</div>
<p><strong>会使用 xargs 的原因是， 很多指令其实并不支持管线命令，因此我们可以透过 xargs 来提供该指令引用 standard input 之用！</strong></p>

<div class="highlighter-rouge">范例五：找出 /sbin 底下具有特殊权限的档名，并使用 ls -l 列出详细属性
[root@www ~]# find /sbin -perm +7000 | ls -l
 # 因为 ll (ls) 并不是管线命令,所以仅列出root所在目录档案
[root@www ~]# find /sbin -perm +7000 | xargs ls -l
-rwsr-xr-x 1 root root 70420 May 25 2008 /sbin/mount.nfs
-rwsr-xr-x 1 root root 70424 May 25 2008 /sbin/mount.nfs4
-rwxr-sr-x 1 root root 5920 Jun 15 2008 /sbin/netreport
</div>

<ol>
  <li>减号<code class="highlighter-rouge">-</code>的用途：</li>
</ol>

<p>在管线命令当中，常常会使用到前一个指令的 stdout 作为这次的stdin ，某些指令需要用到文件名 (例如 tar) 来进行处理时，该 stdin 与 stdout 可以利用减号 “-“ 来替代。</p>

<p><code class="highlighter-rouge">[root@www ~]# tar -cvf - /home | tar -xvf -</code>
&gt; 将<code class="highlighter-rouge">/home</code>里面的档案打包，但打包的数据不是纪录到档案，而是传送到stdout； 经过管线后，将<code class="highlighter-rouge">tar -cvf - /home</code>传送给后面的<code class="highlighter-rouge">tar -xvf -</code>。后面的这个<code class="highlighter-rouge">-</code>则是取用前一个指令的 stdout， 因此，就不需要使用 file 了！</p>


            </article>
        </div>
      </div>
      <div class="panel docs-content">
        <article class="post-content">
          <div class="wrapper">
            


  <div class="ds-thread" data-thread-key="/2016/12/06/learn-bash/" data-title="认识与学习bash" data-url="http://localhost:4000/2016/12/06/learn-bash/"></div>

<script type="text/javascript">
var duoshuoQuery = {short_name:"Gossie"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
</script>


 
          </div>
        </article>
      </div>
    </div>
  </div>
</div>

    
    <footer class="footer" role="contentinfo">
	<div class="container">
		<p class="copyright">Copyright &copy; 2014-2017 <a href=""><code>Gossie</code></a>.</p>
		<p>Site powered by <a href="http://jekyllrb.com">Jekyll</a> && <a href="http://www.github.com">Github</a></p>
	</div>
</footer>

<script src="/styles/js/jquery.min.js"></script>
<script src="/styles/js/bootstrap.min.js"></script>
<script src="/styles/js/holder.min.js"></script>
<script src="/styles/js/application.js"></script>
<script src="/styles/js/lessismore.js"></script>


  </body>
</html>
