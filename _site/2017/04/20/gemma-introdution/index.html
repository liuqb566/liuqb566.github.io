<!DOCTYPE html>
<html>

  <head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>gemma 简单使用</title>

	<link rel="shortcut icon" href="/styles/images/favicon.jpg">
	<link rel="icon" href="/styles/images/favicon.jpg">

	<link rel="stylesheet" href="/styles/css/index.css">
	<link rel="stylesheet" href="/styles/css/fontawesome/css/font-awesome.min.css">
	<link rel="canonical" href="/2017/04/20/gemma-introdution/">
	<link rel="alternate" type="application/rss+xml" title="Gossie's daily life" href="/feed.xml">
	
	<meta name="description" content="">

	<script src="/styles/js/jquery.min.js"></script>
	<!--[if lt IE 9]>
    	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  	<![endif]-->
  	<script>
		var _hmt = _hmt || [];
		(function() {
		  var hm = document.createElement("script");
		  hm.src = "//hm.baidu.com/hm.js?94be4b0f9fc5d94cc0d0415ea6761ae9";
		  var s = document.getElementsByTagName("script")[0]; 
		  s.parentNode.insertBefore(hm, s);
		})();
	</script>
  	<style type="text/css">
	  	.docs-content{
	  		margin-bottom: 10px;
	  	}
  	</style>
</head>


  <body class="index">

    <header class="navbar navbar-inverse navbar-fixed-top docs-nav" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="/" class="navbar-brand">
        <img src="/styles/images/logo.jpg">
      </a>
    </div>
    <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
      <ul class="nav navbar-nav">    
        <li>
          <a href="/">Home</a>
        </li>
        <li>
          <a href="/categories/">分类</a>
        </li>
        <li>
          <a href="/tag">标签</a>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
          <a href="/donate/"><strong>打赏</strong></a>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">关于<b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a rel="nofollow" target="_blank" href="https://github.com/liuqibao566">Github</a></li>
            <li><a rel="nofollow" target="_blank" href="">关于作者</a></li>
            <li><a rel="nofollow" href="/books">书架</a></li>
            <li><a rel="nofollow" href="/reference">相关链接</a></li>
            <li><a href="/feed.xml">RSS订阅</a></li>
            <li class="divider"></li>
            <li><a rel="nofollow" target="_blank" href="https://github.com/liuqb566/">本项目</a></li>
          </ul>
        </li>
      </ul>
    </nav>
  </div>
</header>

    <div class="docs-header" id="content">
  <div class="container">
  	
  		<!--
		    <h1>gemma 简单使用</h1>
		    <p>Post on Apr 20, 2017 by <a href="/about">Gossie</a></p>
		-->
		    <h1></h1>
    
  </div>
</div>
    
      
<div class="banner">
  <div class="container">
  	
    	<a href="/categories/#bioinformatics-ref">bioinformatics</a>	/
    	<a href="/tag/#使用手册-ref">使用手册</a>
    
  </div>
</div>

    

    <div class="container docs-container">
  <div class="row">
    <div class="col-md-3">
      <div class="sidebar hidden-print" role="complementary">
        <div id="navigation">
  <h1>目录</h1>
  <ul class="nav sidenav">
<!--
    
      
      
      
      

      
        <li><a href="#year_2017">2017</a>
          <ul class="nav">
            <li><a href="#month_2017_October">October</a></li>
      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_June">June</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_May">May</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_April">April</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_March">March</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_February">February</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2017_January">January</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
        
            </ul>
          </li>
          <li><a href="#year_2016">2016</a>
            <ul class="nav">
              <li><a href="#month_2016_December">December</a></li>
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
              <li><a href="#month_2016_November">November</a></li>
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            
          
        
      
    
      
      
      
      

      

      
            </ul>
          </li>
      
    
-->
  </ul>
</div> 
      </div>
    </div>
    <div class="col-md-9" role="main">
      <div class="panel docs-content">
        <div class="wrapper">
            <header class="post-header">
              <h1 class="post-title">gemma 简单使用</h1>
              <!--
                <p class="post-meta">Apr 20, 2017</p>
              -->
              <div class="meta">Posted on <span class="postdate">Apr 20, 2017</span> By <a target="_blank" href="http://localhost:4000">Gossie</a></div>
              <br />
            </header>
            <article class="post-content">
              <ul id="markdown-toc">
  <li><a href="#section" id="markdown-toc-section">2. 输入文件格式</a></li>
  <li><a href="#plink-binary-ped-" id="markdown-toc-plink-binary-ped-">2.1 PLINK Binary PED 格式</a>    <ul>
      <li><a href="#bimbam-" id="markdown-toc-bimbam-">2.2 BIMBAM 文件格式</a></li>
      <li><a href="#section-1" id="markdown-toc-section-1">2.3 相关性矩阵文件格式</a>        <ul>
          <li><a href="#section-2" id="markdown-toc-section-2">2.3.1 原始矩阵格式</a></li>
          <li><a href="#section-3" id="markdown-toc-section-3">2.3.2 特征值和特征向量格式</a></li>
        </ul>
      </li>
      <li><a href="#section-4" id="markdown-toc-section-4">2.4 协变量文件格式（可选）</a></li>
      <li><a href="#betaz-" id="markdown-toc-betaz-">2.5 Beta/Z 文件</a></li>
      <li><a href="#section-5" id="markdown-toc-section-5">2.6 分类文件</a></li>
      <li><a href="#ld-score-" id="markdown-toc-ld-score-">2.7 LD Score 文件</a></li>
    </ul>
  </li>
  <li><a href="#gemma" id="markdown-toc-gemma">3. 运行 GEMMA</a>    <ul>
      <li><a href="#gwas-" id="markdown-toc-gwas-">3.1 一个 GWAS 例子的小数据集</a></li>
      <li><a href="#snp-" id="markdown-toc-snp-">3.2 SNP 过滤器</a></li>
      <li><a href="#section-6" id="markdown-toc-section-6">3.3 用线性模型进行关联检验</a>        <ul>
          <li><a href="#section-7" id="markdown-toc-section-7">3.3.1 基本应用</a>            <ul>
              <li><a href="#section-8" id="markdown-toc-section-8">3.3.2 详细信息</a></li>
            </ul>
          </li>
          <li><a href="#section-9" id="markdown-toc-section-9">3.3.3 输出文件</a></li>
        </ul>
      </li>
      <li><a href="#section-10" id="markdown-toc-section-10">3.4 估计来自基因型的相关性矩阵</a>        <ul>
          <li><a href="#section-11" id="markdown-toc-section-11">3.4.1 基本应用</a></li>
          <li><a href="#section-12" id="markdown-toc-section-12">3.4.2 详细信息</a></li>
          <li><a href="#section-13" id="markdown-toc-section-13">3.4.3 输出文件</a></li>
        </ul>
      </li>
      <li><a href="#eigen-decomposition" id="markdown-toc-eigen-decomposition">3.5 进行相关矩阵的 Eigen-Decomposition</a>        <ul>
          <li><a href="#section-14" id="markdown-toc-section-14">3.5.1 基本应用</a></li>
          <li><a href="#section-15" id="markdown-toc-section-15">3.5.2 详细信息</a></li>
          <li><a href="#section-16" id="markdown-toc-section-16">3.5.3 输出文件</a></li>
        </ul>
      </li>
      <li><a href="#section-17" id="markdown-toc-section-17">3.6 单变量线性混合模型的关联检验</a>        <ul>
          <li><a href="#section-18" id="markdown-toc-section-18">3.6.1 基本应用</a></li>
          <li><a href="#section-19" id="markdown-toc-section-19">3.6.2 详细信息</a></li>
          <li><a href="#section-20" id="markdown-toc-section-20">3.6.3 输出文件</a></li>
        </ul>
      </li>
      <li><a href="#section-21" id="markdown-toc-section-21">3.7 多变量线性混合模型的关联检验</a>        <ul>
          <li><a href="#section-22" id="markdown-toc-section-22">3.7.1 基本应用</a></li>
          <li><a href="#section-23" id="markdown-toc-section-23">3.7.2 详细信息</a></li>
          <li><a href="#section-24" id="markdown-toc-section-24">3.7.3 输出文件</a></li>
        </ul>
      </li>
      <li><a href="#fit-a-bayesian-sparse-linear-mixed-modelbslmm" id="markdown-toc-fit-a-bayesian-sparse-linear-mixed-modelbslmm">3.8 Fit a Bayesian Sparse Linear Mixed Model（BSLMM）</a>        <ul>
          <li><a href="#section-25" id="markdown-toc-section-25">3.8.1 基本应用</a></li>
          <li><a href="#section-26" id="markdown-toc-section-26">3.8.2 详细信息</a>            <ul>
              <li><a href="#section-27" id="markdown-toc-section-27">3.8.3 输出文件</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li><a href="#bslmm-" id="markdown-toc-bslmm-">3.9 用来自 BSLMM 的输出文件预测表型</a>        <ul>
          <li><a href="#section-28" id="markdown-toc-section-28">3.9.1 基本应用</a></li>
          <li><a href="#section-29" id="markdown-toc-section-29">3.9.2 详细信息</a></li>
          <li><a href="#section-30" id="markdown-toc-section-30">3.9.3 输出文件</a></li>
        </ul>
      </li>
      <li><a href="#section-31" id="markdown-toc-section-31">3.10 相关性矩阵的方差分量估计</a>        <ul>
          <li><a href="#section-32" id="markdown-toc-section-32">3.10.1 基本应用</a></li>
          <li><a href="#section-33" id="markdown-toc-section-33">3.10.2 详细信息</a></li>
          <li><a href="#section-34" id="markdown-toc-section-34">3.10.3 输出文件</a></li>
        </ul>
      </li>
      <li><a href="#summary-statistics-" id="markdown-toc-summary-statistics-">3.11 Summary Statistics 的方差分量估计</a>        <ul>
          <li><a href="#section-35" id="markdown-toc-section-35">3.11.1 基本应用</a></li>
          <li><a href="#section-36" id="markdown-toc-section-36">3.11.4 详细信息</a></li>
          <li><a href="#section-37" id="markdown-toc-section-37">3.11.3 输出文件</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<p>GEMMA 要求基因型文件不能有缺失值，因此，SNP 要先 impute。
虽然有表型缺失的个体不会用于 LMM 或者 BSLMM 分析，但是所有个体仍全部用于计算相关矩阵，所以相关矩阵的结果仍是 n x n 的矩阵。
### 1. 安装</p>

<p>gemma 安装很简单，直接下载二进制可执行文件就行，不用解压，不用编译。
最好再给它执行权限，<code class="highlighter-rouge">chmod a+x gemma</code>。
这已经足够 45,000 的样本的分析，如果你的数据更大，可以使用编译安装。</p>

<h3 id="section">2. 输入文件格式</h3>

<p>GEMMA 需要四个主要的输入文件，包括基因型、表型、相关矩阵和协变量（可选）。
基因型和表型文件可以是两种格式，都是 PLINK binary ped 格式或者都 BIMBAM 格式。不可混用。</p>

<h3 id="plink-binary-ped-">2.1 PLINK Binary PED 格式</h3>

<p>GEMMA 识别基因型型和表型的 PLINK binary ped 文件格式.
该格式需要三个文件：*.bed, *.bim, *.bam，所有文件都有相同的前缀。
用户可以用 PLINK 将标准 ped 文件转换成 binary ped 文件：
命令：
<code class="highlighter-rouge">
plink --file [file_prefix] --make-bed --out [bedfile_prefix]
</code>
对于 *.fam 文件，GEMMA 仅读取第二列（individual id）和第六列（phenotype）.
用户可以定义其它列作为 phenotype 列，使用 ‘-n [num]’ 参数，’-n 1’ 使用原始的第六列作为 phenotypes，’-n 2’ 使用第七列，以此类推。
GEMMA 用 0/1 编码等位基因。
*.bim 文件的第 5 列是 minor allele ，编码为 1；第 6 列为 major allele ，编码为 0.
因此，第 5 列的 minor allele 是效应基因。</p>

<p>GEMMA 将按照提供的方式读入表型，’-9‘ 和 ‘NA’ 作为缺失表型。</p>

<h4 id="bimbam-">2.2 BIMBAM 文件格式</h4>

<p>详见<a href="http://zzz.bwh.harvard.edu/plink/data.shtml">使用手册</a></p>

<h4 id="section-1">2.3 相关性矩阵文件格式</h4>

<p>两种方法，使用原始相关矩阵，或者使用原始相关矩阵的特征值和特征微量。</p>

<h5 id="section-2">2.3.1 原始矩阵格式</h5>

<p>用户可以通过 ’-km [num]’ 参数选择使用哪种格式，即：
-km 1：PLINK binary ped 格式的第一种；或者 BIMPAM 格式；
-km 2: PLINK binary ped 格式的第二种（id id value）</p>

<h5 id="section-3">2.3.2 特征值和特征向量格式</h5>

<p>详见原文</p>

<h4 id="section-4">2.4 协变量文件格式（可选）</h4>

<h4 id="betaz-">2.5 Beta/Z 文件</h4>

<h4 id="section-5">2.6 分类文件</h4>

<h4 id="ld-score-">2.7 LD Score 文件</h4>

<h3 id="gemma">3. 运行 GEMMA</h3>

<h4 id="gwas-">3.1 一个 GWAS 例子的小数据集</h4>

<p>该数据集在 GEMMA 的源文件中，可以在官网下载，也可以在 GitHub 下载。</p>

<h4 id="snp-">3.2 SNP 过滤器</h4>

<p>软件提供了几个 SNP 过滤器。</p>

<p>多态性：没有多态性的 SNPs 不会用于分析。
缺失值：‘-miss [num]’ 参数调节，默认 5%。例，’-miss 0.1’
最小等位基因频率：‘-maf [num]’ 参数调节，默认 1%。例，’-maf 0.05’
Correlation with any covariate：’-r2 [num]‘ 调节，默认 0.9999。例，’-r2 0.999999
哈迪——温勃格平衡：‘-hww [num]’ 参数调节。例，‘-hwe 0.001’，将过滤 hwe 的 p 值小于 0.001 的 SNPs。</p>

<p>以上阈值计算基于分析的个体（即，个体没有缺失的表型和没有缺失的协变量）。
因此，如果所有的个体都有缺失表型，那么没有 SNP 会被分析，输出矩阵为空。</p>

<h4 id="section-6">3.3 用线性模型进行关联检验</h4>

<h5 id="section-7">3.3.1 基本应用</h5>

<p>用 PLINK bed 格式或者 BIMBAM 格式进行线性模型关联分析的基本应用：
<code class="highlighter-rouge">
./gemma -bfile [prefix] -lm [num] -o [prefix]
./gemma -g [filename] -p [filename] -a [filename] -lm [num] -o [prefix]
</code></p>

<p>-lm：指定用哪种频数检验
  -lm 1：Wald test
  -lm 2: likelihood ratio test
  -lm 3：score test
  -lm 4: 以上三种检验
-bfile [prefix]: PLINK binary ped file 前缀
-g [filename]：BIMBAM mean genotype 文件名
-p [filename]：BIMBAM 表型文件名
-a [filename]：可选，BIMBAM SNP 注释文件名
-o [prefix] ：输出文件前缀</p>

<p>注意：与线性混合模型不同，该分析不需要相关性矩阵</p>

<h6 id="section-8">3.3.2 详细信息</h6>

<p>对二进制性状，用户可以将对照组标记为 0 ，实验组标记为 1，然后通过把二进制化的对照实验标签当作数量性状，跟据以上方法用线性混合模型拟合数据。</p>

<h5 id="section-9">3.3.3 输出文件</h5>

<p>共有两个输出文件，都在当前目录下的文件夹中。
‘preix.log.txt’ 文件有一些关于运行参数和计算时间的细节信息。除此之外，还包含 PBE 检测和它的标准误。
’prefix.assoc.txt’ 文件包含结果。例如：
<code class="highlighter-rouge">
chr rs ps n_mis n_obs allele1 allele0 af beta se p_wald
1 rs3683945 3197400 0 1410 A G 0.443 -1.586575e-01 3.854542e-02 4.076703e-05
1 rs3707673 3407393 0 1410 G A 0.443 -1.563903e-01 3.855200e-02 5.252187e-05
1 rs6269442 3492195 0 1410 A G 0.365 -2.349908e-01 3.905200e-02 2.256622e-09
1 rs6336442 3580634 0 1410 A G 0.443 -1.566721e-01 3.857380e-02 5.141944e-05
1 rs13475700 4098402 0 1410 A C 0.127 2.209575e-01 5.644804e-02 9.497902e-05
</code>
这 11 行是：染色体、SNP id、碱基对在染色体上的位置、相应 SNP 的缺失个体数量、相应 SNP 的无缺个体数量、最小等位基困、最大等位基因、等位基因频率、beta 检测、beta 标准误、Wald 检验的 P 值。</p>

<h4 id="section-10">3.4 估计来自基因型的相关性矩阵</h4>

<h5 id="section-11">3.4.1 基本应用</h5>

<div class="highlighter-rouge">./gemma -bfile [prefix] -gk [num] -o [prefix]
./gemma -g [filename] -p [filename] -gk [num] -o [prefix]
</div>
<p>-gk [num]: 估计哪种相关性矩阵：
  -gk 1: centered relatedness matrix, 默认
  -gk 2: standardized relatedness matrix
-bfile [prefix]: PLINK binary ped file prefix
-g [filename]: 见 3.3
-p [filename]:  见 3.3
-o [prefix]: 见 3.3</p>

<p>注意：BIMBAM mean genotype 文件可以用 gzip 压缩格式</p>

<h5 id="section-12">3.4.2 详细信息</h5>

<p>较低的最小等位基因频率趋于较大的效应：standardized genotype atrix
SNP 的效应大小不依赖于最小等位基因频率：ecntered genotype matrix</p>

<h5 id="section-13">3.4.3 输出文件</h5>

<h4 id="eigen-decomposition">3.5 进行相关矩阵的 Eigen-Decomposition</h4>

<h5 id="section-14">3.5.1 基本应用</h5>

<div class="highlighter-rouge">./gemma -bfile [prefix] -k [filename] -eigen -o [prefix]
./gemma -g [filename] -p [filename] -k [filename] -eigen -o [prefix]
</div>
<p>-b：见前文
-g：见前文
-p：见前文
-k [filename]：相关矩阵文件名</p>

<p>注意：BIMBAM mean genotype/相关矩阵文件格式可以是 gzip 压缩格式</p>

<h5 id="section-15">3.5.2 详细信息</h5>

<h5 id="section-16">3.5.3 输出文件</h5>

<h4 id="section-17">3.6 单变量线性混合模型的关联检验</h4>

<h5 id="section-18">3.6.1 基本应用</h5>

<div class="highlighter-rouge">./gemma -bfile [prefix] -k [filename] -lmm [num] -o [prefix]
./gemma -g [filename] -p [filename] -a [filename] -k [filename] -lmm [num] -o [prefix]
</div>
<p>-lmm：指定用哪种频数检验
  -lmm 1：Wald test
  -lmm 2: likelihood ratio test
  -lmm 3：score test
  -lmm 4: 以上三种检验
-bfile [prefix]: PLINK binary ped file 前缀
-g [filename]：BIMBAM mean genotype 文件名
-p [filename]：BIMBAM 表型文件名
-a [filename]：可选，BIMBAM SNP 注释文件名
-o [prefix] ：输出文件前缀
-k [filename]：相关矩阵文件名</p>

<p>为检测基因-环境的交互作用，你可以加 ’-gxe [filename]’ 参数。
注意：‘-k [filename]’ 可以用 ‘-d [filename]’ （特征值文件）和 ‘-u [filename]’ （特征向量文件）所代替。</p>

<h5 id="section-19">3.6.2 详细信息</h5>

<h5 id="section-20">3.6.3 输出文件</h5>

<p>见前文</p>

<h4 id="section-21">3.7 多变量线性混合模型的关联检验</h4>

<h5 id="section-22">3.7.1 基本应用</h5>

<div class="highlighter-rouge">./gemma -bfile [prefix] -k [filename] -lmm [num] -n [num1] [num2] [num3] -o [prefix]
./gemma -g [filename] -p [filename] -a [filename] -k [filename] -lmm [num] -n [num1] [num2] [num3] -o [prefix]
</div>

<p>-lmm：指定用哪种频数检验
  -lmm 1：Wald test
  -lmm 2: likelihood ratio test
  -lmm 3：score test
  -lmm 4: 以上三种检验
-n [num1] [num2] [num3]: 表型文件中哪些表型用于关联
-bfile [prefix]: PLINK binary ped file 前缀
-g [filename]：BIMBAM mean genotype 文件名
-p [filename]：BIMBAM 表型文件名
-a [filename]：可选，BIMBAM SNP 注释文件名
-o [prefix] ：输出文件前缀
-k [filename]：相关矩阵文件名</p>

<p>为检测基因-环境的交互作用，你可以加 ’-gxe [filename]’ 参数。
注意：‘-k [filename]’ 可以用 ‘-d [filename]’ （特征值文件）和 ‘-u [filename]’ （特征向量文件）所代替。</p>

<h5 id="section-23">3.7.2 详细信息</h5>

<p>建议表型的数量小于 10 个。
当表型的一小部分缺失的时候，用户可以在关联前推测缺失值:
<code class="highlighter-rouge">
./gemma -bfile [prefix] -k [filename] -predict -n [num1] [num2] [num3] -o [prefix]
./gemma -g [filename] -p [filename] -a [filename] -k [filename] -predict -n [num1] [num2] [num3] -o [prefix]
</code></p>

<h5 id="section-24">3.7.3 输出文件</h5>

<p>见前文</p>

<h4 id="fit-a-bayesian-sparse-linear-mixed-modelbslmm">3.8 Fit a Bayesian Sparse Linear Mixed Model（BSLMM）</h4>

<h5 id="section-25">3.8.1 基本应用</h5>

<div class="highlighter-rouge">./gemma -bfile [prefix] -bslmm [num] -o [prefix]
./gemma -g [filename] -p [filename] -a [filename] -bslmm [num] -o [prefix]

</div>
<p>-bslmm [num]：
  -bslmm 1: a standard linear BSLMM，使用 MCMC
  -bslmm 2: a ridge regression/GBLUP，使用 standard non-MCMC 方法。最快
  -bslmm 3: a probit BSLMM，使用 MCMC。最慢</p>

<h5 id="section-26">3.8.2 详细信息</h5>

<p>注意：拟合 BSLMM 需要大量内存（例，4000 个体，400，000 SNPs，20 GB 内存），因为软件会存储整个基因型矩阵到内存中。
foat 版本（gemmaf）可以在不会缺失太大精度的情况下节省一半的内存。</p>

<p>GEMMA 默认不需要用户提供相关性矩阵，它会自动计算，你也可以通过 ‘-k [filename]’ 自己提供。
在拟合 BSLMM 的时候，GEMMA 不需要协变量文件，然而，用户可以用 BIMBAM mean genotype 文件存储协变量，用 ‘-notsnp’ 参数使用它们。</p>

<p>使用基于 MCMC 的方法时，用户可以通过 ‘-w [num]’ 选择 burn-in iterations 的数量，‘-s [num]’ 选择 sampling iterations 的数量。
此外，用户可以使用 ‘-smax [num]’ 选择用于模型的最大 SNPs 数量（即，有加性效应的 SNPs），probit BSLMM 很需要，因为它的计算负担重。
为了平衡计算精度和计算时间，用户可以自己决定使用这些参数。</p>

<h6 id="section-27">3.8.3 输出文件</h6>

<p>共有 5 个输出文件，位于当前目录的输出文件夹下。
prefix.log.txt：
prefix.hyp.txt：
prefix.param.txt：
prefix.bv.txt：一列育种值
prefix.gamma.txt：</p>

<h4 id="bslmm-">3.9 用来自 BSLMM 的输出文件预测表型</h4>

<h5 id="section-28">3.9.1 基本应用</h5>

<div class="highlighter-rouge">./gemma -bfile [prefix] -epm [filename] -emu [filename] -ebv [filename] -k [filename] -predict [num] -o [prefix]
./gemma -g [filename] -p [filename] -epm [filename] -emu [filename] -ebv [filename] -k [filename] -predict [num] -o [prefix]
</div>
<p>-predict [num]: 预测值需要用正态累积分布函数（CDF）额外转换
  -predict 1: 获得预测值
  -predict 2: 获得预测值，用 CDF 将它们转换成概率大小。仅拟合 probit BSLMM 时用。
-epm [filename]：来自 BSLMM 的 prefix.param.txt
-emu [filename]: prefix.log.txt from BSLMM
-ebv [filename]: prefix.bv.txt from BSLMM
-k [filename]: 相关性矩阵</p>

<h5 id="section-29">3.9.2 详细信息</h5>

<p>使用拟合 BSLMM 中的同一个表型文件和基因型文件。
如果用户使用默认矩阵进行拟合 BSLMM，那么在第二步不需要提供 ‘-bev’ 和 ‘-k’。</p>

<h5 id="section-30">3.9.3 输出文件</h5>

<p>在当前目录的输出文件夹下有两个输出文件。
prefix.log.txt:
prefix.prdt.txt:有一列所有个体的预测值</p>

<h4 id="section-31">3.10 相关性矩阵的方差分量估计</h4>

<h6 id="section-32">3.10.1 基本应用</h6>

<div class="highlighter-rouge">./gemma -p [filename] -k [filename] -n [num] -vc [num] -o [prefix]
./gemma -p [filename] -mk [filename] -n [num] -vc [num] -o [prefix]
</div>
<p>-vc: 作用哪种估计方式：
  -vc 1: 默认，使用 HE regression
  -vc 2: REML AI 算法
-n [num]: 使用表型的哪一列，默认 1</p>

<h5 id="section-33">3.10.2 详细信息</h5>

<p>默认 REML AI 算法的方差分量估计限制为正，用户可以在 ’-vc 2‘ 上用 ’-noconstrain‘。
HE regression 没有限制</p>

<h5 id="section-34">3.10.3 输出文件</h5>

<h4 id="summary-statistics-">3.11 Summary Statistics 的方差分量估计</h4>

<h5 id="section-35">3.11.1 基本应用</h5>

<div class="highlighter-rouge">./gemma -beta [filename] -bfile [prefix] -vc 1 -o [prefix]
./gemma -beta [filename] -g [filename] -p [filename] -a [filename] -vc 1 -o [prefix]
</div>
<p>-vc 1: MQS-HEW
-beta [filename]: beta 文件名</p>

<h5 id="section-36">3.11.4 详细信息</h5>

<h5 id="section-37">3.11.3 输出文件</h5>


            </article>
        </div>
      </div>
      <div class="panel docs-content">
        <article class="post-content">
          <div class="wrapper">
            


  <div class="ds-thread" data-thread-key="/2017/04/20/gemma-introdution/" data-title="gemma 简单使用" data-url="http://localhost:4000/2017/04/20/gemma-introdution/"></div>

<script type="text/javascript">
var duoshuoQuery = {short_name:"Gossie"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
</script>


 
          </div>
        </article>
      </div>
    </div>
  </div>
</div>

    
    <footer class="footer" role="contentinfo">
	<div class="container">
		<p class="copyright">Copyright &copy; 2014-2017 <a href=""><code>Gossie</code></a>.</p>
		<p>Site powered by <a href="http://jekyllrb.com">Jekyll</a> && <a href="http://www.github.com">Github</a></p>
	</div>
</footer>

<script src="/styles/js/jquery.min.js"></script>
<script src="/styles/js/bootstrap.min.js"></script>
<script src="/styles/js/holder.min.js"></script>
<script src="/styles/js/application.js"></script>
<script src="/styles/js/lessismore.js"></script>


  </body>
</html>
